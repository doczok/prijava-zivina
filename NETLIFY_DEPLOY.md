# Deploy to Netlify with Neon Database

## ✅ You're all set! Just follow these steps:

### 1. Get Your Neon Connection String

In your Neon dashboard (https://console.neon.tech/):
1. Select your database project
2. Go to "Connection Details"
3. Copy the **Connection string** (it looks like: `postgresql://user:password@ep-xxx.region.neon.tech/dbname?sslmode=require`)

### 2. Add Environment Variable to Netlify

1. Go to your Netlify dashboard: https://app.netlify.com
2. Select your site (or create new site from GitHub: `doczok/prijava-zivina`)
3. Go to **Site settings** → **Environment variables**
4. Click **Add a variable**
5. Add:
   - **Key**: `DATABASE_URL`
   - **Value**: Your Neon connection string (from step 1)
6. Click **Save**

### 3. Deploy

**If site exists:**
1. Go to **Deploys** tab
2. Click **Trigger deploy** → **Deploy site**

**If creating new site:**
1. Click **Add new site** → **Import an existing project**
2. Connect to GitHub
3. Select repository: `doczok/prijava-zivina`
4. Build settings:
   - **Build command**: `npx prisma generate && npm run build`
   - **Publish directory**: `.next`
5. Add the `DATABASE_URL` environment variable
6. Click **Deploy**

### 4. Create Database Tables

After first deploy, you need to create the tables:

**Option A: Using Netlify CLI** (if you have it installed)
\`\`\`bash
netlify env:set DATABASE_URL "your-neon-connection-string"
netlify build
npx prisma db push
\`\`\`

**Option B: Manually via Neon SQL Editor**
1. Go to Neon dashboard → SQL Editor
2. Run this SQL:

\`\`\`sql
-- This will be generated by Prisma, but here's the structure
CREATE TABLE "Claim" (
    "id" TEXT NOT NULL PRIMARY KEY,
    "osiguranik" TEXT NOT NULL,
    "radnaJedinica" TEXT NOT NULL,
    "vrsta" TEXT NOT NULL,
    -- ... rest of schema
);
\`\`\`

**Option C: Best - Use Prisma Migrate** 
Locally with Neon credentials:
\`\`\`bash
# Add Neon URL to your local .env temporarily
DATABASE_URL="your-neon-connection-string"

# Push schema
npx prisma db push

# Remove from local .env after
\`\`\`

### 5. Verify

Visit your Netlify URL and try creating a claim. It should now save to Neon!

## Build Command for Netlify

Make sure your Netlify build command includes Prisma generation:
\`\`\`
npx prisma generate && npm run build
\`\`\`

## Environment Variables Needed

- ✅ `DATABASE_URL`: Your Neon PostgreSQL connection string

That's it! Your app will use:
- **PostgreSQL (Neon)** in production on Netlify
- **SQLite** for local development

## Troubleshooting

**"No DATABASE_URL" error**: Make sure environment variable is set in Netlify

**Database connection failed**: 
- Check Neon connection string is correct
- Ensure Neon database is active (not in sleep mode)
- Try regenerating Neon password

**Tables don't exist**:
- Run `npx prisma db push` with Neon credentials
- Or use Neon SQL editor to create tables manually
